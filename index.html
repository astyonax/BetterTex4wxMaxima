<!DOCTYPE html><html lang=en><head><title>Better Tex</title><meta content="Sandbox to clean wxMaxima 'Copy to Latex' output" name=description><meta content=Latex,tex,regex,javascript,wxmaxima,maxima name=keywords><meta content="Guglielmo Saggiorato" name=author><link rel=icon href=files/black_square_36x36.png type=image/png><meta content="text/html; charset=us-ascii" http-equiv=content-type><meta charset=utf-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1" name=viewport><meta content="max-age=3600" http-equiv=Cache-Control><link rel=stylesheet href=files/bootstrap.min.css media=none onload='"all"!=media&&(media="all")'><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css media=none onload='"all"!=media&&(media="all")'><link rel=stylesheet rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css media=none onload='"all"!=media&&(media="all")'><style>body{color:#2D2E33;}
  div.raw{background-color:#DB5461;}
  div.optimized{background-color:#FFD166;}
  div.container{max-width:1200px;}
  /*#navbar{white-space:nowrap;}*/
  div.eq{max-width:100%;}
  #Sandbox>.row{background-color:#06D6A0;}
  .footer>.row{background-color:#eeeeee;padding:1em 1em 0 0;border-top: 1px solid #dddddd;text-align:center;}
  #About h4{padding-top:1em;}
  .bold{font-weight: bold; }</style></head><body><nav class="navbar navbar-default"><div class=navbar-header><button class=navbar-toggle aria-label="Toggle NavBar" data-target=#thenavbar data-toggle=collapse type=button><span class=icon-bar></span> <span class=icon-bar></span> <span class=icon-bar></span></button> <a href=# class=navbar-brand>Better\(\TeX\)4WxMaxima</a></div><ul id=thenavbar class="collapse nav navbar-collapse navbar-nav"><li><a href=#Simplify>Simplify</a></li><li><a href=#Sandbox>Sandbox</a></li><li><a href=#About>About</a></li></ul></nav><div class=container id=Simplify onclick=BetterIt(MathInput.value)><div class="row raw"><div class=col-md-6><h3 id=lblMathInput>Original TeX as from Maxima</h3><div class=form-group><textarea class=form-control id=MathInput rows=8 width=100% aria-labelledby=lblMathInput>
\begin{align}
  \frac{\left( -8 \mathit{tU} U+4 b\, \mathit{ii}\, {{\mathit{tU}}^{2}}-2 \mathit{TnnT}\, \mathit{ii}\right)  \lambda}{2}&amp;\\
  {\left( .. \right)}&amp;\\
  {m^2}&amp;\\
  \frac{\left( .. \right)}{m^2}&amp;
\end{align}
        </textarea><button class="btn btn-primary" onclick=BetterIt(MathInput.value)>Show (CTRL+ENTER)</button></div></div><div class=col-md-6><h3>Original Equation</h3><div class="align-middle eq" id=raw_eq>$${}$$</div></div></div><div class="row optimized"><div class=col-md-6><h3>Simplified TeX</h3><div class=form-group><div class=align-middle><pre><code class=tex id=opt_tex></code></pre></div></div></div><div class=col-md-6><h3>Simplified Equation</h3><div id=opt_eq>$${}$$</div></div>Not what you expected? Have a look in the <a href=#QA>Q&amp;A</a> section, and at the <a href=https://github.com/astyonax/BetterTex4wxMaxima/issues>Issues</a> page.</div></div><div class=container id=Sandbox><div class=row><div class=col-md-6><h2>Sandbox</h2><label for=RegExSandbox>RegEx:</label><input class=form-control id=RegExSandbox rows=1 type=text value=\\,\s*?(\w) width=100%><label for=SubsSandbox>Substitute with:</label><input class=form-control id=SubsSandbox rows=1 type=text value=$1 width=100%></div><div class=col-md-6><label for=RegExHelp>Regular Expressions help</label><ul id=RegExHelp><li><a href=https://regex101.com/ >Regex 101</a></li><li><a href=https://github.com/crazyguitar/pysheeet/blob/master/docs/notes/python-rexp.rst>Python regular expressions cheat sheet</a></li></ul></div></div><div class=row><div class=col-md-6><label for=MathSandbox>\(\TeX\):</label><textarea class=form-control id=MathSandbox rows=8 width=100%>\Delta_{\mu^\nu}
        </textarea><button class="btn btn-primary" onclick=doregex(MathSandbox.value,RegExSandbox.value,SubsSandbox.value)>Go</button></div><div class=col-md-6><label for=regex_eq>Transformed</label><div class=align-middle><pre><code class=tex id=regex_eq></code></pre></div></div></div><div class=row><div class=col-md-12><div class=align-middle id=regex_math>$${}$$</div></div></div></div><div class=container id=About><div class=row><div class=col-md-2></div><div class=col-md-8><h2>About</h2>The \(\TeX\) output of <a href=http://andrejv.github.io/wxmaxima/ >wxMaxima <i aria-hidden=true class="fa fa-external-link"></i> </a>is not so readable. This page implements some regex to bring it down to a more palatable format; one other option is to call maxima's <a href=http://maxima.sourceforge.net/docs/manual/maxima_singlepage.html#Item_003a-tex><code>tex()</code> <i aria-hidden=true class="fa fa-external-link"></i> </a>function on the expression to convert to TeX. The current regex(es) do not cope with all cases, and may break the \(\TeX\) itself, for this reason the optimized code is rendered alongside to the original one. In the section <a href=#Sandbox>Sandbox</a> one can tweak a custom regex to obtain the desidered result. Issues and suggested regex shall be reported in the <a href=https://github.com/astyonax/BetterTex4wxMaxima/issues>Issues page</a> of the project home in github.com<h3 id=QA>Q&amp;A</h3><h4>How does it work?</h4>I transform the original \(\TeX\) code with a set of regex(es). As first step, I remove useless keywords, such as <i>\mathit</i>, togheter with annoying useles braces. The corresponding code snippet reads<pre><code class=js>TeX = TeX.replace(new RegExp('{{0,1}'+remove_list[i]+'{([a-zA-Z0-9]+?)}{1,2}','gm'),'$1');</code></pre>Then a set of regex(es) are applied to remove the surrounding braces in cases like <code class=tex>{\left(... \right)}</code>, or <code class=tex>{m^2}</code>. At the moment, these transformations protect cases like <code class=tex>\frac{\left( .. \right)}{m^2}</code>. The essential, and minimal code is<pre><code class=js>cleanTex = function (TeX){
  // cleans the tex. transformations order is not commutative
  var remove_list = ['\\\\ensuremath','\\\\mathit'];
  for (i=0;i&lt;remove_list.length;i++){
      TeX = TeX.replace(new RegExp('{{0,1}'+remove_list[i]+'{([a-zA-Z0-9]+?)}{1,2}','gm'),' $1 ');
    }
  // interecepts ^{a}-&gt; ^a with a=one caracter
  // interecepts ^{a}-&gt; ^a with a=one caracter
  TeX = TeX.replace(/\^{([a-zA-Z0-9])}/gm,"^$1");
  // intercepts {\a_command^a_char} -- protected if begins with c{..} or }{} as would be in \frac{..}{..}
  TeX = TeX.replace(/([^}c]){(\\*[^{]*?\^[a-zA-Z0-9])}/gm,"$1 $2");
  // intercepts {\left(..\right)} -- protected if begins with c{..} or }{} as would be in \frac{..}{..}
  TeX = TeX.replace(/[^}c]{(\\left\(.+?\\right\))\s*}/gm,"$1");
  // intercepts {optional_command or words} -- protected if begins with c{..} or }{} as would be in \frac{..}{..}
  TeX = TeX.replace(/[^}c]{(\\\\*\s*\w+?\s*)}/gm,"$1 ");
  return TeX;
}</code></pre><h4>Can I help?</h4>Yes. By finding wxMaxima's \(\TeX\) code for which the transformation rules do not work.<h4>The new \(\TeX\) does not work</h4>If the transformation rule skews up the original \(\TeX\), please open an <a href=https://github.com/astyonax/BetterTex4wxMaxima/issues>Issue</a> reporting both the original and the optimized codes. The <strong>best</strong> would be if you can prepare a minimal example which shows the same behaviour.<h4>Why is it not being cleaned enough?</h4>The reason is simple. I did not see your particular edge case, so there is no transformation rule able to intercept your case. You can open an <a href=https://github.com/astyonax/BetterTex4wxMaxima/issues>Issue</a>, reporting your original and optimized eq, alongside with the wanted version. The <strong>best</strong> is that you use the sandbox to craft a regex that does the job on the already optimized code. Then open an <a href=https://github.com/astyonax/BetterTex4wxMaxima/issues>Issue</a> to propose such regex.</div><div class=col-md-2></div></div></div><script src=js/passivate.js></script><script src=js/jquery.min.js async></script><script src=js/bootstrap.min.js async></script><script src=js/highlight.pack.js async></script><script>function go(e){e.ctrlKey&&13==e.keyCode&&BetterIt(MathInput.value)}cleanTex=function(e){var t=["\\\\ensuremath","\\\\mathit"];for(i=0;i<t.length;i++)e=e.replace(new RegExp("{{0,1}"+t[i]+"{([a-zA-Z0-9]+?)}{1,2}","gm"),"$1");return e=e.replace(/([^}ct]){([a-zA-Z0-9]*?)}\^/gm,"$1 $2^"),e=e.replace(/\^{([a-zA-Z0-9])}/gm,"^$1"),e=e.replace(/([^}ct]){\s*(\\*[^{]*?\^{{0,1}[a-zA-Z0-9]*?}{0,1})\s*}/gm,"$1 $2"),e=e.replace(/[^}ct]{(\\left\(.+?\\right\))\s*}/gm,"$1"),e=e.replace(/[^}ct]{(\\\\*\s*\w+?\s*)}/gm," $1 "),e=e.replace(/{ /gm,"{")},window.BetterIt=function(e){t=MathJax.Hub.getAllJax(raw_eq)[0];MathJax.Hub.Queue(["Text",t,"{"+e+"}"]),e=cleanTex(e),MathSandbox.value=e,opt_tex.innerHTML=e,hljs.highlightBlock(opt_tex);var t=MathJax.Hub.getAllJax(opt_eq)[0];MathJax.Hub.Queue(["Text",t,"{"+e+"}"])},window.doregex=function(e,t,a){l=MathJax.Hub.getAllJax(regex_eq)[0];e=e.replace(new RegExp(t,"gm"),a),regex_eq.innerHTML=e,hljs.highlightBlock(regex_eq);var l=MathJax.Hub.getAllJax(regex_math)[0];MathJax.Hub.Queue(["Text",l,"\\displaystyle{"+e+"}"])},document.addEventListener("keyup",go,!1)</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async type=text/javascript>MathJax.Hub.Queue(function(){BetterIt(MathInput.value),doregex(MathSandbox.value,RegExSandbox.value,SubsSandbox.value)}),hljs.initHighlightingOnLoad()</script><div class="container footer"><div class=row><div class=col-md-12>&#9400; 2017 - <i aria-hidden=true class="fa bold fa-code" aria-label=Coded></i> with <i aria-hidden=true class="fa bold fa-flask" aria-label=love></i> by <a href=https://github.com/astyonax>Guglielmo Saggiorato <i aria-hidden=true class="fa fa-github" aria-label="hosted on github.com"></i></a></div></div></div></body></html>